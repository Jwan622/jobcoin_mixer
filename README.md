## Jobcoin Mixer


# Table of Contents
1. [Getting Started](#getting_started)
2. [TransactionHandler](#transaction_handler)
3. [Distributor](#distributor)
4. [Edge Cases](#edge_cases)

## Getting Started

After cloning the repo, cd into the folder and run:

```
rackup -p 3000
```

and go to `localhost:3000` in your browser.

Do not run the application using ruby:

```ruby
ruby './app.rb' -p 3000
```
The above will bypass the configuration in `config.ru`



## Transaction Handler

Let's say we have these transactions.

# insert global transactions

The `TransactionHandler` will filter transactions that were sent to mixed addresses generated by our `JobcoinMixer`.

```ruby
TransactionHandler.new(transaction_history, HouseDistributor::IDENTIFIER).process
```

In the above code, the `TransactionHandler` polls the Jobcoin history for transactions that sent to addresses created by the Mixer. These addresses can then be used to send money from the mixed address to the House Account.

```ruby
{"toAddress"=>"52c7ec313568730cbadff4cb7b59dd5696d9917393f07ba92d74a6b3d1cc93a4057dd6ab03ddde6d938180ff", "amount"=>10.0, "fromAddress"=>["1444"]}]
[{"toAddress"=>"0297bc772c4f6854b5eae2ce674fcf46f23d3574f1f13989919faaaf11c873", "amount"=>50.256899999999995, "fromAddress"=>["1444", "alice", "Alice"]},
 {"toAddress"=>"52cfe12035675455afcdc4dd6852dd4499463ce04f1c37bb17c645b26b4b4116", "amount"=>2.11, "fromAddress"=>["1444"]},
 {"toAddress"=>"52c7ec313568730cbadff4cb7b59dd5696d9917393f07ba92d74a6b3d1cc93a4057dd6ab03ddde6d938180ff", "amount"=>10.0, "fromAddress"=>["1444"]}]
```

Only the above addresses will be returned.


__NOTE__: Composition helps here to make this TransactionHandler more reusable. Provide it a set of transactions and an identifer and the handler will return only transactions with a `toAddress` encrypted by the identifier.


## Distributor

Issues:
1. How to make the methods idempotent. If one fails, I should be able to safely rerun the methods without running the risk of duplicate transfers.


- The house account has all the aggregated jobcoins. The issue here is determining which accounts to transfer jobcoins to while also avoiding duplicate
transfers.

## Edge Cases
1. Say you mix 3 addresses into an address, let's call it AddressB. IF you then deposit an amount of
JobCoin into AddressB that does not divide evenly 3 ways, you wind up with more coins. For example,
Say you mix 3 addresses and then try to transfer 2.3 JobCoin to the mixed address. Each of the
three addresses will receive 0.7666666666666667 JobCoin which, when multiple by 3,
comes out to more than 2.3. This is a bug that should be fixed since we can create infinite
JobCoin this way.



## Image Choice
- Xhibit meme was the clearest choice I had all project.
